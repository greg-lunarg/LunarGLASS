
Top IR:
; ModuleID = 'Glslang'

%gl_PerVertex = type { <4 x float>, float, [4 x float], <4 x float>, <4 x float>, <4 x float>, <4 x float>, <4 x float>, [1 x <4 x float>], float }
%s2 = type { i32, [4 x %s1] }
%s1 = type { i32, i32, [3 x <4 x float>] }

@"anon@0" = global %gl_PerVertex zeroinitializer
@iv4 = global <4 x float> zeroinitializer
@ps = external addrspace(2) constant float
@s2out = global %s2 zeroinitializer
@ui = external addrspace(2) constant i32
@gl_VertexID = global i32 0
@gl_InstanceID = global i32 0

define fastcc void @main() {
entry:
  %i = alloca i32
  br label %mainBody

mainBody:                                         ; preds = %entry
  %0 = load <4 x float>* @iv4
  store <4 x float> %0, <4 x float>* getelementptr inbounds (%gl_PerVertex* @"anon@0", i32 0, i32 0)
  %1 = load float addrspace(2)* @ps, !gla.uniform !37
  store float %1, float* getelementptr inbounds (%gl_PerVertex* @"anon@0", i32 0, i32 1)
  %2 = load <4 x float>* @iv4
  %3 = extractelement <4 x float> %2, i32 0
  store float %3, float* getelementptr inbounds (%gl_PerVertex* @"anon@0", i32 0, i32 2, i32 2)
  %4 = load i32* %i
  %5 = load float addrspace(2)* @ps, !gla.uniform !37
  %6 = getelementptr %s2* @s2out, i32 0, i32 1, i32 %4, i32 2, i32 2, i32 3
  store float %5, float* %6
  br label %stage-epilogue

stage-epilogue:                                   ; preds = %mainBody
  br label %stage-exit

stage-exit:                                       ; preds = %stage-epilogue
  ret void
}

!gla.entrypoint = !{!0}
!gla.outputs = !{!1, !25}
!gla.inputs = !{!31, !33, !35}
!gla.uniforms = !{!37, !38}
!gla.noStaticUse = !{!38, !33, !35}

!0 = !{!"main", i32 15}
!1 = !{!"", i32 16, %gl_PerVertex* @"anon@0_typeProxy", !2, !3}
!2 = !{i32 0, i32 0, i32 1024, null, i32 0, i32 0, i32 -1, i32 0, i32 -1}
!3 = !{!"gl_PerVertex", !4, !"gl_Position", !5, !"gl_PointSize", !7, !"gl_ClipDistance", !9, !"gl_ClipVertex", !11, !"gl_FrontColor", !13, !"gl_BackColor", !15, !"gl_FrontSecondaryColor", !17, !"gl_BackSecondaryColor", !19, !"gl_TexCoord", !21, !"gl_FogFragCoord", !23}
!4 = !{i32 0, i32 0, i32 1024, null, i32 -1, i32 0, i32 -1, i32 0, i32 -1}
!5 = !{!"", !6}
!6 = !{i32 0, i32 0, i32 1024, null, i32 -1, i32 9, i32 -1, i32 0, i32 -1}
!7 = !{!"", !8}
!8 = !{i32 0, i32 0, i32 1024, null, i32 -1, i32 10, i32 -1, i32 0, i32 -1}
!9 = !{!"", !10}
!10 = !{i32 0, i32 0, i32 1024, null, i32 -1, i32 12, i32 -1, i32 0, i32 -1}
!11 = !{!"", !12}
!12 = !{i32 0, i32 0, i32 1024, null, i32 -1, i32 11, i32 -1, i32 0, i32 -1}
!13 = !{!"", !14}
!14 = !{i32 0, i32 0, i32 1024, null, i32 -1, i32 24, i32 -1, i32 0, i32 -1}
!15 = !{!"", !16}
!16 = !{i32 0, i32 0, i32 1024, null, i32 -1, i32 25, i32 -1, i32 0, i32 -1}
!17 = !{!"", !18}
!18 = !{i32 0, i32 0, i32 1024, null, i32 -1, i32 26, i32 -1, i32 0, i32 -1}
!19 = !{!"", !20}
!20 = !{i32 0, i32 0, i32 1024, null, i32 -1, i32 27, i32 -1, i32 0, i32 -1}
!21 = !{!"", !22}
!22 = !{i32 0, i32 0, i32 1024, null, i32 -1, i32 28, i32 -1, i32 0, i32 -1}
!23 = !{!"", !24}
!24 = !{i32 0, i32 0, i32 1024, null, i32 -1, i32 29, i32 -1, i32 0, i32 -1}
!25 = !{!"s2out", i32 7, %s2* @s2out_typeProxy, !26, !27}
!26 = !{i32 4, i32 0, i32 1038, null, i32 1, i32 0, i32 -1, i32 0, i32 -1}
!27 = !{!"s2", !28, !"c", !29, !"d", !30}
!28 = !{i32 4, i32 0, i32 1024, null, i32 -1, i32 0, i32 -1, i32 0, i32 -1}
!29 = !{!"", !4}
!30 = !{!"s1", !28, !"a", !29, !"a2", !29, !"b", !29}
!31 = !{!"iv4", i32 1, <4 x float>* @iv4_typeProxy, !32}
!32 = !{i32 0, i32 0, i32 1037, null, i32 0, i32 0, i32 -1, i32 0, i32 -1}
!33 = !{!"gl_VertexID", i32 2, i32* @gl_VertexID_typeProxy, !34}
!34 = !{i32 0, i32 0, i32 1059, null, i32 0, i32 7, i32 -1, i32 0, i32 -1}
!35 = !{!"gl_InstanceID", i32 3, i32* @gl_InstanceID_typeProxy, !36}
!36 = !{i32 0, i32 0, i32 1060, null, i32 0, i32 8, i32 -1, i32 0, i32 -1}
!37 = !{!"ps", i32 12, float* @ps_typeProxy, !4}
!38 = !{!"ui", i32 12, i32* @ui_typeProxy, !4}


Bottom IR:
; ModuleID = 'Glslang'
target datalayout = "e-p:32:32"

%gl_PerVertex = type { <4 x float>, float, [4 x float], <4 x float>, <4 x float>, <4 x float>, <4 x float>, <4 x float>, [1 x <4 x float>], float }
%s2 = type { i32, [4 x %s1] }
%s1 = type { i32, i32, [3 x <4 x float>] }

@"anon@0" = global %gl_PerVertex zeroinitializer
@iv4 = global <4 x float> zeroinitializer
@ps = external addrspace(2) constant float
@s2out = global %s2 zeroinitializer
@gl_VertexID = global i32 0
@gl_InstanceID = global i32 0

define fastcc void @main() {
entry:
  %0 = load <4 x float>* @iv4
  %gla_constGEP = getelementptr %gl_PerVertex* @"anon@0", i32 0, i32 0
  store <4 x float> %0, <4 x float>* %gla_constGEP
  %1 = load float addrspace(2)* @ps
  %gla_constGEP1 = getelementptr %gl_PerVertex* @"anon@0", i32 0, i32 1
  store float %1, float* %gla_constGEP1
  %2 = extractelement <4 x float> %0, i32 0
  %gla_constGEP2 = getelementptr %gl_PerVertex* @"anon@0", i32 0, i32 2, i32 2
  store float %2, float* %gla_constGEP2
  store float %1, float* getelementptr (%s2* @s2out, i32 0, i32 1, i32 undef, i32 2, i32 2, i32 3)
  br label %stage-epilogue

stage-epilogue:                                   ; preds = %entry
  br label %stage-exit

stage-exit:                                       ; preds = %stage-epilogue
  ret void
}

!gla.entrypoint = !{!0}
!gla.outputs = !{!1, !25}
!gla.inputs = !{!31, !33, !35}
!gla.uniforms = !{!37, !38}
!gla.noStaticUse = !{!38, !33, !35}

!0 = !{!"main", i32 15}
!1 = !{!"", i32 16, %gl_PerVertex* @"anon@0_typeProxy", !2, !3}
!2 = !{i32 0, i32 0, i32 1024, null, i32 0, i32 0, i32 -1, i32 0, i32 -1}
!3 = !{!"gl_PerVertex", !4, !"gl_Position", !5, !"gl_PointSize", !7, !"gl_ClipDistance", !9, !"gl_ClipVertex", !11, !"gl_FrontColor", !13, !"gl_BackColor", !15, !"gl_FrontSecondaryColor", !17, !"gl_BackSecondaryColor", !19, !"gl_TexCoord", !21, !"gl_FogFragCoord", !23}
!4 = !{i32 0, i32 0, i32 1024, null, i32 -1, i32 0, i32 -1, i32 0, i32 -1}
!5 = !{!"", !6}
!6 = !{i32 0, i32 0, i32 1024, null, i32 -1, i32 9, i32 -1, i32 0, i32 -1}
!7 = !{!"", !8}
!8 = !{i32 0, i32 0, i32 1024, null, i32 -1, i32 10, i32 -1, i32 0, i32 -1}
!9 = !{!"", !10}
!10 = !{i32 0, i32 0, i32 1024, null, i32 -1, i32 12, i32 -1, i32 0, i32 -1}
!11 = !{!"", !12}
!12 = !{i32 0, i32 0, i32 1024, null, i32 -1, i32 11, i32 -1, i32 0, i32 -1}
!13 = !{!"", !14}
!14 = !{i32 0, i32 0, i32 1024, null, i32 -1, i32 24, i32 -1, i32 0, i32 -1}
!15 = !{!"", !16}
!16 = !{i32 0, i32 0, i32 1024, null, i32 -1, i32 25, i32 -1, i32 0, i32 -1}
!17 = !{!"", !18}
!18 = !{i32 0, i32 0, i32 1024, null, i32 -1, i32 26, i32 -1, i32 0, i32 -1}
!19 = !{!"", !20}
!20 = !{i32 0, i32 0, i32 1024, null, i32 -1, i32 27, i32 -1, i32 0, i32 -1}
!21 = !{!"", !22}
!22 = !{i32 0, i32 0, i32 1024, null, i32 -1, i32 28, i32 -1, i32 0, i32 -1}
!23 = !{!"", !24}
!24 = !{i32 0, i32 0, i32 1024, null, i32 -1, i32 29, i32 -1, i32 0, i32 -1}
!25 = !{!"s2out", i32 7, %s2* @s2out_typeProxy, !26, !27}
!26 = !{i32 4, i32 0, i32 1038, null, i32 1, i32 0, i32 -1, i32 0, i32 -1}
!27 = !{!"s2", !28, !"c", !29, !"d", !30}
!28 = !{i32 4, i32 0, i32 1024, null, i32 -1, i32 0, i32 -1, i32 0, i32 -1}
!29 = !{!"", !4}
!30 = !{!"s1", !28, !"a", !29, !"a2", !29, !"b", !29}
!31 = !{!"iv4", i32 1, <4 x float>* @iv4_typeProxy, !32}
!32 = !{i32 0, i32 0, i32 1037, null, i32 0, i32 0, i32 -1, i32 0, i32 -1}
!33 = !{!"gl_VertexID", i32 2, i32* @gl_VertexID_typeProxy, !34}
!34 = !{i32 0, i32 0, i32 1059, null, i32 0, i32 7, i32 -1, i32 0, i32 -1}
!35 = !{!"gl_InstanceID", i32 3, i32* @gl_InstanceID_typeProxy, !36}
!36 = !{i32 0, i32 0, i32 1060, null, i32 0, i32 8, i32 -1, i32 0, i32 -1}
!37 = !{!"ps", i32 12, float* @ps_typeProxy, !4}
!38 = !{!"ui", i32 12, i32* @ui_typeProxy, !4}
#version 150 core
// LunarGOO output
struct s1 {
	int a;
	int a2;
	vec4 b[3];
};
struct s2 {
	int c;
	s1 d[4];
};
uniform float ps;
uniform int ui;
in vec4 iv4;
out s2 s2out;

void main()
{
	gl_Position = iv4;
	gl_PointSize = ps;
	gl_ClipDistance[2] = iv4.x;
	s2out.d[0].b[2].w = ps;
	
}

